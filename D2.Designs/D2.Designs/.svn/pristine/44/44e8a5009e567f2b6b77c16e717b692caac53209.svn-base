use db_rksecu;
TRUNCATE db_rksecu.tb_rksedm_custom_dimension_stock;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SGG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE (tssi.stock_name LIKE 'ST%' or tssi.stock_name LIKE '*ST%' or tssi.stock_name LIKE 'S*ST%' or tssi.stock_name LIKE 'SST%' )AND (tssi.exch_no = 1 or tssi.exch_no =  2) AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.stock_name LIKE 'S%' AND tssi.stock_name NOT LIKE 'ST%' AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'STG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.stock_name LIKE 'ST%'AND (tssi.exch_no = 1 or tssi.exch_no =  2) AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, '*STG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.stock_name LIKE '*ST%'AND (tssi.exch_no = 1 or tssi.exch_no =  2) AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'S*STG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.stock_name LIKE 'S*ST%'AND (tssi.exch_no = 1 or tssi.exch_no =  2) AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SSTG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.stock_name LIKE 'SST%'AND (tssi.exch_no = 1 or tssi.exch_no =  2) and tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SHAG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no=1 AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SZAG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no=2 AND tssi.stock_code NOT LIKE '002%' AND tssi.stock_code NOT LIKE '300%' AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SZZXB' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no=2 AND tssi.stock_code LIKE '002%' AND tssi.stock_type=1 ;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SZCYB' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no=2 AND tssi.stock_code LIKE '300%' AND tssi.stock_type=1 ;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'HSAG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE (tssi.exch_no=1 or (tssi.exch_no=2 AND tssi.stock_code NOT LIKE '002%' AND tssi.stock_code NOT LIKE '300%')) AND tssi.stock_type=1 ;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SZZXC' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no=2 AND (tssi.stock_code LIKE '002%' or tssi.stock_code LIKE '300%') AND tssi.stock_type=1;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'ZQ' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no in(1,2)  AND tssi.stock_type in(21,22,23,24,25,30,37,40,41,42,43) ;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'FHBJJ' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no in(1,2)  AND tssi.stock_type in(51,52,53,54,55,56,58,59,60,62,64);
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'HSAGZXB' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE (tssi.exch_no=1 or (tssi.exch_no=2 AND tssi.stock_code NOT LIKE '300%')) AND tssi.stock_type=1 ;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'XG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE (tssi.exch_no=1 or tssi.exch_no=2 ) AND tssi.stock_type=1 AND tssi.stock_name like 'N%';
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'FHS300' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE (tssi.exch_no=1 or tssi.exch_no=2 ) AND tssi.stock_type=1 AND tssi.stock_code not in (select stock_code from tb_rksedm_index_stock where index_code = 'HS300');
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'GG' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE (tssi.exch_no=3 or tssi.exch_no=4 ) AND tssi.stock_type=1 ;
INSERT INTO db_rksecu.tb_rksedm_custom_dimension_stock(create_date, create_time, update_date, update_time, update_times,dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,weight_value,weight_ratio,remark_info) SELECT DISTINCT date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), date_format(curdate(),'%Y%m%d'), date_format(curtime(),'%H%i%s'), 1, 'SZAGHZXC' AS dime_type_code,exch_no,stock_code_no, stock_code,stock_name,stock_type,0 AS weight_value,0 AS weight_ratio,' ' as remark_info FROM db_rksecu.tb_rksecc_secu_stock_info tssi WHERE tssi.exch_no=2 AND tssi.stock_type=1;
commit;
